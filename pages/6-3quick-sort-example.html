<section id="6-3quick-sort-example" class="content-page">
    <h2>クイックソートの仕組み（5個）</h2>
    <p>クイックソートの動作を、5つの要素で見てみましょう。ここではピボットを各部分配列の最後の要素とし、Lomutoパーティションスキームを用います。</p>
    <p>配列: `[34, 8, 64, 51, 32]`</p>
    <h3>初期呼び出し: `quickSort([34, 8, 64, 51, 32], 0, 4)`</h3>
    <ol>
        <li>ピボット: `arr[4]` = `32`</li>
        <li>パーティショニング (arr, 0, 4, pivot=32):
            <ul>
                <li>`i = -1` (0-1)</li>
                <li>`j = 0`: `arr[0]`(34) > 32.</li>
                <li>`j = 1`: `arr[1]`(8) <= 32. `i` becomes 0. `swap(arr[0], arr[1])`. Array: `[8, 34, 64, 51, 32]`</li>
                <li>`j = 2`: `arr[2]`(64) > 32.</li>
                <li>`j = 3`: `arr[3]`(51) > 32.</li>
                <li>ループ終了。 `swap(arr[i+1], arr[4])` => `swap(arr[1], arr[4])`.</li>
                <li>Array: `[8, 32, 64, 51, 34]`. ピボット `32` の最終位置はインデックス `1`。</li>
            </ul>
        </li>
        <li>ピボット `32` の位置: 1</li>
        <li>再帰呼び出し1: `quickSort([8, 32, 64, 51, 34], 0, 0)` (左部分 `[8]`)
            <ul>
                <li>要素数1なので終了。 `[8]` はソート済み。</li>
            </ul>
        </li>
        <li>再帰呼び出し2: `quickSort([8, 32, 64, 51, 34], 2, 4)` (右部分 `[64, 51, 34]`)</li>
    </ol>
    <h3>再帰呼び出し2: `quickSort([8, 32, 64, 51, 34], 2, 4)`</h3>
    <ol>
        <li>対象配列の部分: `[64, 51, 34]` (インデックス 2 から 4)</li>
        <li>ピボット: `arr[4]` = `34`</li>
        <li>パーティショニング (arr, 2, 4, pivot=34):
            <ul>
                <li>`i = 1` (2-1)</li>
                <li>`j = 2`: `arr[2]`(64) > 34.</li>
                <li>`j = 3`: `arr[3]`(51) > 34.</li>
                <li>ループ終了。 `swap(arr[i+1], arr[4])` => `swap(arr[2], arr[4])`.</li>
                <li>Array: `[8, 32, 34, 51, 64]`. ピボット `34` の最終位置はインデックス `2`。</li>
            </ul>
        </li>
        <li>ピボット `34` の位置: 2</li>
        <li>再帰呼び出し2-1: `quickSort([8, 32, 34, 51, 64], 2, 1)` (左部分なし、low > high) -> 終了</li>
        <li>再帰呼び出し2-2: `quickSort([8, 32, 34, 51, 64], 3, 4)` (右部分 `[51, 64]`)</li>
    </ol>
    <h3>再帰呼び出し2-2: `quickSort([8, 32, 34, 51, 64], 3, 4)`</h3>
    <ol>
        <li>対象配列の部分: `[51, 64]` (インデックス 3 から 4)</li>
        <li>ピボット: `arr[4]` = `64`</li>
        <li>パーティショニング (arr, 3, 4, pivot=64):
            <ul>
                <li>`i = 2` (3-1)</li>
                <li>`j = 3`: `arr[3]`(51) <= 64. `i` becomes 3. `swap(arr[3], arr[3])`. Array: `[8, 32, 34, 51, 64]`</li>
                <li>ループ終了。 `swap(arr[i+1], arr[4])` => `swap(arr[4], arr[4])`.</li>
                <li>Array: `[8, 32, 34, 51, 64]`. ピボット `64` の最終位置はインデックス `4`。</li>
            </ul>
        </li>
        <li>ピボット `64` の位置: 4</li>
        <li>再帰呼び出し2-2-1: `quickSort([8, 32, 34, 51, 64], 3, 3)` (左部分 `[51]`)
            <ul>
                <li>要素数1なので終了。 `[51]` はソート済み。</li>
            </ul>
        </li>
        <li>再帰呼び出し2-2-2: `quickSort([8, 32, 34, 51, 64], 5, 4)` (右部分なし、low > high) -> 終了</li>
    </ol>
    <p>全ての再帰呼び出しが終了すると、配列全体がソートされています。</p>
    <p><strong>最終結果: `[8, 32, 34, 51, 64]`</strong></p>
    <p>（注: Lomutoパーティションスキームはピボットが常に部分配列の最後に配置されるため、説明がやや複雑になることがあります。Hoareパーティションスキームや、ピボットを最初に選んでから左右を詰めていく方法など、他のパーティション方法も存在します。）</p>
</section>